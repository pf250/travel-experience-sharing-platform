<view class="container">
  <!-- å¸–å­åˆ—è¡¨ -->
  <block wx:for="{{posts}}" wx:key="_id">
    <view class="post-card">
      <view class="userinfo">
        <!-- å¤´åƒ -->
        <image class="avatar" src="{{item.avatarUrl}}"></image>
        <!-- æ˜µç§° -->
        <text class="username">{{item.nickName}}</text>
        <!-- ç”¨æˆ·ä¿¡æ¯ -->
        <view class="post-meta">
          <text class="post-author">Uid: {{item.userId}}</text>
          <text class="post-time">{{formatTime(item.createdAt)}}</text>
        </view>
      </view>
      <!-- æ ‡é¢˜ -->
      <view class="post-title">{{item.title}}</view>
      <!-- æè¿° -->
      <view class="post-description">{{item.description}}</view>
      <!-- å›¾ç‰‡ -->
      <view class="post-images" wx:if="{{item.images.length > 0}}">
        <image
          wx:for="{{item.images}}"
          wx:key="index"
          src="{{item}}"
          mode="aspectFill"
          class="post-image"
        ></image>
      </view>

      <!-- ç‚¹èµå’Œè¯„è®º -->
      <view class="post-actions">
        <!-- ç‚¹èµæŒ‰é’® -->
        <button
          class="like-btn"
          bindtap="handleLike"
          data-post-id="{{item._id}}"
        >
          <text>ğŸ‘</text> {{item.likeCount || 0}}
        </button>
        <!-- è¯„è®ºæŒ‰é’® -->
        <button
          class="comment-btn"
          bindtap="showComments"
          data-post-id="{{item._id}}"
        >
          <text>ğŸ’¬</text> {{item.commentCount || 0}}
        </button>
      </view>
      <!-- è¯„è®ºåŒºåŸŸï¼ˆå¼¹å‡ºå±‚ï¼‰ -->
      <view class="comments-section" wx:if="{{currentPostId === item._id}}">
        <view class="comment-list">
          <block wx:for="{{comments}}" wx:key="_id">
            <view class="comment-item">
              <text class="comment-author">{{item.userId}}:</text>
              <text class="comment-content">{{item.content}}</text>
            </view>
          </block>
        </view>
        <!-- å‘è¡¨è¯„è®ºè¾“å…¥æ¡† -->
        <view class="comment-input">
          <input
            type="text"
            placeholder="å‘è¡¨è¯„è®º..."
            value="{{newComment}}"
            bindinput="onCommentInput"
          />
          <button bindtap="handleComment" data-post-id="{{item._id}}">
            å‘è¡¨
          </button>
        </view>
      </view>
    </view>
  </block>
</view>