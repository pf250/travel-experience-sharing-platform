<!-- applications.wxml -->
<view class="container">
  <!-- å›ºå®šå¤´éƒ¨æ ‡é¢˜ -->
  <view class="fixed-header">
    <view class="header-content">
      <view class="title">å•†å®¶ç”³è¯·è®°å½•</view>
      <view class="subtitle">å…± {{applications.length}} æ¡ç”³è¯·</view>
    </view>
  </view>

  <!-- ç”³è¯·è®°å½•åˆ—è¡¨ -->
  <scroll-view 
    class="list-container" 
    scroll-y 
    enable-back-to-top
    bindscrolltolower="onReachBottom"
    refresher-enabled
    bindrefresherrefresh="onPullDownRefresh"
    refresher-triggered="{{loading && page === 1}}"
    style="padding-top: {{headerHeight}}px"
  >
    <!-- åŸæ¥çš„åˆ—è¡¨å†…å®¹ä¿æŒä¸å˜ -->
    <!-- åŠ è½½çŠ¶æ€ -->
    <view wx:if="{{loading && applications.length === 0}}" class="loading">
      <view class="loading-text">åŠ è½½ä¸­...</view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view wx:if="{{!loading && applications.length === 0}}" class="empty">
      <view class="empty-icon">ğŸ“„</view>
      <view class="empty-text">æš‚æ— ç”³è¯·è®°å½•</view>
      <view class="empty-subtext">å¿«å»æäº¤å•†å®¶ç”³è¯·å§</view>
    </view>

    <!-- ç”³è¯·è®°å½•åˆ—è¡¨ -->
    <view wx:for="{{applications}}" wx:key="_id" class="application-item">
      <view class="card">
        <!-- çŠ¶æ€æ  -->
        <view class="status-bar {{item.statusInfo.className}}">
          <view class="status">{{item.statusInfo.text}}</view>
          <view class="time">{{item.formattedTime}}</view>
        </view>

        <!-- ç”³è¯·ä¿¡æ¯ -->
        <view class="content">
          <!-- ç…§ç‰‡é¢„è§ˆ -->
          <view wx:if="{{item.photoUrl}}" class="photo-section">
            <view class="photo-label">ç”³è¯·ç…§ç‰‡ï¼š</view>
            <image 
              src="{{item.photoUrl}}" 
              class="photo" 
              mode="aspectFit"
              data-index="{{index}}"
              bindtap="previewImage"
            />
          </view>

          <!-- ç”³è¯·ID -->
          <view class="info-row">
            <view class="label">ç”³è¯·IDï¼š</view>
            <view class="value">{{item._id}}</view>
          </view>

          <!-- ç”³è¯·åŸå›  -->
          <view wx:if="{{item.reason}}" class="info-row">
            <view class="label">ç”³è¯·åŸå› ï¼š</view>
            <view class="value">{{item.reason}}</view>
          </view>

          <!-- æ‹’ç»åŸå›  -->
          <view wx:if="{{item.rejectReason}}" class="info-row">
            <view class="label">æ‹’ç»åŸå› ï¼š</view>
            <view class="value reject-reason">{{item.rejectReason}}</view>
          </view>
        </view>
      </view>
    </view>

    <!-- åŠ è½½æ›´å¤š -->
    <view wx:if="{{loading && applications.length > 0}}" class="loading-more">
      <view class="loading-text">åŠ è½½ä¸­...</view>
    </view>

    <view wx:if="{{!hasMore && applications.length > 0}}" class="no-more">
      æ²¡æœ‰æ›´å¤šæ•°æ®äº†
    </view>
  </scroll-view>
</view>